<html DIR="LTR" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=Windows-1252"></META><META NAME="save" CONTENT="history"></META><title>Limited User Account Predictor Verification Layer</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"></link><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"></input><input type="hidden" id="hiddenScrollOffset"></input></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"></img><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"></img><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"></img><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"></img><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"></img><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"></img><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Limited User Account Predictor Verification Layer</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p>The Limited User Account Privilege Predictor (LuaPriv) has two primary goals:</p><ol class="ordered"><li>
Predictive: While running an application with administrative privilege, predict whether that application would work as well if run with less privilege (generally, as a normal user).  For example, if the application writes to files that only allow Administrators access, then that application won’t be able to write to the same file if run as a non-administrator. <br /><br /></li><li>
Diagnostic: When running as a non-administrator, identify potential problems that may already exist with the current run.  Continuing the previous example, if the application tries to write to a file that only grants members of the Administrators group access, the application will get an ACCESS_DENIED error.  If the application doesn’t operate correctly, this operation may be the culprit. <br /><br /></li></ol><p>The types of problems that LuaPriv identifies are as follows:</p><h3 class="subHeading"></h3><table><tr><td colspan="1"><p><b>Potential Issue</b></p></td><td colspan="1"><p><b>Description</b></p></td></tr><tr><td colspan="1"><p>Restricted Namespaces</p></td><td colspan="1"><p>Creating a named synchronization object (Event, Semaphore, Mutex, etc) without a namespace may complicate running without privilege on some operating systems because the operating system may choose to place the object in a restricted namespace.  </p><p>Creating such an object in a restricted namespace (such as the Global namespace) requires SeCreateGlobalPrivilege, which is only granted to administrators.  </p><p>LuaPriv flags both these issues if it detects them.</p></td></tr><tr><td colspan="1"><p>Hard Administrator Checks</p></td><td colspan="1"><p>Some applications interrogate the user’s security token to find out how much privilege he/she has.  In those cases, the application may change its behavior depending on how much power it thinks the user is granted.  </p><p>LuaPriv flags API calls that return this information.</p></td></tr><tr><td colspan="1"><p>Requesting Privileges</p></td><td colspan="1"><p>An application may attempt to enable a security-relevant privilege (such as SeTcbPrivilege or SeSecurityPrivilege) prior to performing an operation that requires it.  </p><p>LuaPriv flags attempts to enable privileges that are security-relevant.</p></td></tr><tr><td colspan="1"><p>Missing Privileges</p></td><td colspan="1"><p>If an application attempts to enable a privilege that the user doesn’t have, it probably signals that the application expects the privilege, which can cause behavior differences.  So, LuaPriv flags failed privilege requests.</p></td></tr><tr><td colspan="1"><p>INI-file operations</p></td><td colspan="1"><p>Attempts to write to mapped INI files (WritePrivateProfileSection and similar APIs) can fail as a non-administrator user.  LuaPriv flags such operations.</p></td></tr><tr><td colspan="1"><p>Access Denied</p></td><td colspan="1"><p>If the application attempts to access an object (File, registry key, etc) but the attempt fails due to insufficient access, then the application probably expects to be running with more privilege than it has.  LuaPriv flags object-open attempts that fail with ACCESS_DENIED and similar errors.</p></td></tr><tr><td colspan="1"><p>Deny ACEs</p></td><td colspan="1"><p>If an object has Deny ACEs in its DACL, then it explicitly denies access to specific entities.  This is uncommon, and makes prediction difficult, so LuaPriv flags Deny ACEs when it finds them.</p></td></tr><tr><td colspan="1"><p>Access Restricted</p></td><td colspan="1"><p>If an application attempts to open an object for rights that are not granted to normal users (for example, trying to write to a file that’s only writeable by administrators), then the application probably won’t work the same when run as a normal user.</p><p>LuaPriv flags such operations.</p></td></tr><tr><td colspan="1"><p>MAXIMUM_ALLOWED</p></td><td colspan="1"><p>If an application opens an object for MAXIMUM_ALLOWED, then the actual access check on the object will occur elsewhere.  Most code that does this doesn’t work correctly, and will almost certainly work differently when run without privilege.  </p><p>LuaPriv thus flags all incidents of MAXIMUM_ALLOWED.</p></td></tr></table><p></p><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><p></p><hr></hr><br /><br /></div></div></body></html>