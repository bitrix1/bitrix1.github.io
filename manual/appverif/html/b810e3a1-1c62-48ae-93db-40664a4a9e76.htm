<html DIR="LTR" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=Windows-1252"></META><META NAME="save" CONTENT="history"></META><title>A Winsock service provider API was called before a successful WSPStartup() or after a balancing successful WSPCleanup() call was made.</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"></link><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"></input><input type="hidden" id="hiddenScrollOffset"></input></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"></img><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"></img><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"></img><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"></img><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"></img><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"></img><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">A Winsock service provider API was called before a successful WSPStartup() or after a balancing successful WSPCleanup() call was made.</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><h2 class="heading">Application Verifier break message</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><p xmlns="">A Winsock service provider API was called before a successful WSPStartup() or after a balancing successful WSPCleanup() call was made</p></content></div><h2 class="heading">Probable cause</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><p xmlns="">A call was made to a Winsock name service provider API before a successful WSPStarup() or after a balancing successful WSPCleanup() call. This is generally pointing to a fault to a specific Winsock layered service provider (LSP) layered between the application and Winsock. WSPStartup is required to provide a reference count by any LSP using Winsock to guarantee initialization for Winsock service provider API usage. An unbalanced WSPStartup/WSPCleanup call pattern by an LSP can lead to undefined behavior as this can cause the Winsock layer to unload libraries and release resources while still being used. </p></content></div><h2 class="heading">Troubleshooting steps</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><p xmlns="">If Parameter 1 is not  NULL,  enter 
    <b>dps </b><i>Parameter 1</i>
   to dump the stack for the last successful WSPStartup call by the LSP in violation.</p><p xmlns="">If Parameter 2 is not  NULL,  enter 
    <b>dps </b><i>Parameter 2</i>
   to dump the stack for the last successful WSPCleanup call by the LSP in violation.</p><p xmlns="">If Parameter 2 is not  NULL,  enter 
    <b>dps </b><i>Parameter 3</i>
   to dump the stack for the last successful WSPStartup call made by any service provider in the process.</p><p xmlns="">If Parameter 4 is not  NULL,  enter 
    <b>dps </b><i>Parameter 4</i>
   to dump the stack for the last successful WSPCleanup call made by any service provider in the process.</p></content></div><h2 class="heading">Information displayed by Application Verifier</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><p xmlns="">Parameter 1 - Last successful WSPStartup call made by the LSP in violation.</p><p xmlns="">Parameter 2 - Last successful WSPCleanup call made by the LSP in violation.</p><p xmlns="">Parameter 3 - Last successful WSPStartup call made by any service provider in the process.</p><p xmlns="">Parameter 4 - Last successful WSPCleanup call made by any service provider in the process.</p></content></div><h2 class="heading">Additional information</h2><div id="sectionSection4" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><p xmlns=""> Test Layer: Net Verifier </p><p xmlns="">Stop code: E108</p><p xmlns="">Severity: Error</p><p xmlns="">One-time error: No</p><p xmlns="">Non Continuable: Yes</p><p xmlns="">Error report: Yes</p><p xmlns="">Log to file: Yes</p><p xmlns="">Create backtrace: Yes</p></content></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><p></p><hr></hr><br /><br /></div></div></body></html>