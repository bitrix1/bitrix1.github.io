<html DIR="LTR" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=Windows-1252"></META><META NAME="save" CONTENT="history"></META><title>Too many open PrintTicket provider handles (HPTPROVIDER)</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"></link><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"></input><input type="hidden" id="hiddenScrollOffset"></input></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"></img><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"></img><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"></img><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"></img><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"></img><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"></img><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Too many open PrintTicket provider handles (HPTPROVIDER)</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p></p><h2 class="heading">Application Verifier break message</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><p xmlns=""> Too many open PrintTicket provider handles (HPTPROVIDER)</p></content></div><h2 class="heading">Probable cause</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><p xmlns=""> Too many PrintTicket provider handles were opened by calling PTOpenProvider(Ex). This might be the result of not calling PTCloseProvider when the handle is no longer needed, creating a resource leak.</p><p xmlns="">The following sample debugger output shows the AppVerifier message that is displayed when 0x000003EB (1003) PrintTicket handles have been opened. In this case, AppVerifier would show this warning three times, one for each handle that is opened after 1,000 handles were open.</p><p xmlns="">=======================================</p><p xmlns="">VERIFIER STOP 0000A00D : pid 0xFBC: Too many open PrintTicket provider handles (HPTPROVIDER)</p><p xmlns="">        000003EB : Number of currently opened PrintTicket provider handles.</p><p xmlns="">        00000000 : Not used.</p><p xmlns="">        00000000 : Not used.</p><p xmlns="">        00000000 : Not used.</p><p xmlns="">=======================================</p></content></div><h2 class="heading">Troubleshooting Steps</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><p xmlns="">This stop is a warning. It might be normal to have more than 1,000 PrintTicket provider handles if the print server has many printers or it might be the result of a resource leak. A resource leak could be caused by not calling PTCloseProvider when necessary. If you think that the number is too high for the number of printers, then review the source code to determine if the print ticket provider handles are being opened and closed correctly.</p></content></div><h2 class="heading">Information displayed by Application Verifier</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><p xmlns=""> Parameter 1 - Number of currently opened PrintTicket provider handles.</p><p xmlns="">Parameter 2 - Not used.</p><p xmlns="">Parameter 3 - Not used.</p><p xmlns="">Parameter 4 - Not used.</p></content></div><h2 class="heading">Additional information</h2><div id="sectionSection4" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><p xmlns=""> Test Layer: PrintAPI</p><p xmlns="">Stop code: 0000A00D</p><p xmlns="">Severity: Warning</p><p xmlns="">One-time error: no</p><p xmlns="">Error report: None</p><p xmlns="">Log to file: yes</p><p xmlns="">Create backtrace: yes</p></content></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><p></p><hr></hr><br /><br /></div></div></body></html>