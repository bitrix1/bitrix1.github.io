<html DIR="LTR" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=Windows-1252"></META><META NAME="save" CONTENT="history"></META><title>Attempt to use an unknown PrintTicket provider handle (HPTPROVIDER)</title><link rel="stylesheet" type="text/css" href="../local/Classic.css"></link><script src="../local/script.js"></script></head><body><div><input type="hidden" id="userDataCache" class="userDataStyle"></input><input type="hidden" id="hiddenScrollOffset"></input></div><img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif"></img><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif"></img><img id="collapseImage" style="display:none; height:0; width:0;" src="../local/collapse.gif"></img><img id="expandImage" style="display:none; height:0; width:0;" src="../local/exp.gif"></img><img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif"></img><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif"></img><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText"></span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Attempt to use an unknown PrintTicket provider handle (HPTPROVIDER)</span></td></tr><tr id="headerTableRow3"><td></td></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p></p><h2 class="heading">Application Verifier break message</h2><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><p xmlns=""> Attempt to use an unknown PrintTicket provider handle (HPTPROVIDER)</p></content></div><h2 class="heading">Probable cause</h2><div id="sectionSection1" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><p xmlns=""> A PrintTicket provider handle was used that was not opened by calling PTOpenProvider or PTOpenProviderEx.</p></content></div><h2 class="heading">Troubleshooting steps:</h2><div id="sectionSection2" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><p xmlns="">The sample debugger output below illustrates how to examine the stack trace to find the function that includes the print ticket provider handle from Parameter 1 in the argument list.</p><p xmlns="">After you identify this function, find the routine that includes this function and examine the source code to determine the open function used to open the handle and correct it if necessary.</p><div class="code" xmlns=""><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>=======================================
VERIFIER STOP 0000A00F : pid 0x16CC: Attempt to use an unknown PrintTicket provider handle (HPTPROVIDER)
        031F4C00 : HPTPROVIDER handle being accessed.
        00000000 : Not used.
        00000000 : Not used.
        00000000 : Not used.
=======================================

0:000&gt; k
ChildEBP RetAddr
000df518 7286385b ntdll!DbgBreakPoint
000df71c 6eee425e vrfcore!VerifierStopMessageEx+0x4bd
000df750 6eee45f6 vfprint!CResourceUsageMgr&lt;HPTPROVIDER__ *,CHandleTracker_t&lt;HPTPROVIDER__ *&gt; &gt;::ClosedHandleCheck+0x70
000df7f4 00143f80 vfprint!VfPTCloseProvider+0x111
000df814 00142edc UnitTestvfPrint!UseCompletelyInvalidPTProviderHandle+0x40 * !Unknown or invalid PrintTicket provider handled used here
000df90c 001450b6 UnitTestvfPrint!wmain+0x3dc
000df950 76413833 UnitTestvfPrint!__wmainCRTStartup+0x102
000df95c 775fa9bd KERNEL32!BaseThreadInitThunk+0xe
000df99c 00000000 ntdll!_RtlUserThreadStart+0x23</pre></td></tr></table></span></div></content></div><h2 class="heading">Information displayed by Application Verifier</h2><div id="sectionSection3" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><p xmlns=""> Parameter 1 - HPTPROVIDER handle being accessed. </p><p xmlns="">Parameter 2 - Not used. </p><p xmlns="">Parameter 3 - Not used. </p><p xmlns="">Parameter 4 - Not used.</p></content></div><h2 class="heading">Additional information</h2><div id="sectionSection4" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"><p xmlns=""> Test Layer: PrintAPI</p><p xmlns="">Stop code: 0000A00F</p><p xmlns="">Severity: Error</p><p xmlns="">One-time error: no</p><p xmlns="">Error report: Break</p><p xmlns="">Log to file: yes</p><p xmlns="">Create backtrace: yes</p></content></div><!--[if gte IE 5]>
			<tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]--></div><div id="footer"><p></p><hr></hr><br /><br /></div></div></body></html>